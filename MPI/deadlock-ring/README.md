Deadlock can be detected with [MUST](https://www.i12.rwth-aachen.de/cms/Lehrstuhl-fuer-Informatik/Forschung/Forschungsschwerpunkte/Lehrstuhl-fuer-Hochleistungsrechnen/~nrbe/MUST/):

```
➜  bauerc@n2login3 deadlock-ring git:(main)
$ mustrun -n 4 run.sh
[MUST] MUST configuration ... centralized checks with fall-back application crash handling (very slow)
[MUST] Using prebuilt infrastructure at /pc2/users/b/bauerc/.cache/must/prebuilds/864f3a9f01045835e9b69e097a4
83388
[MUST] Weaver ... success
[MUST] Generating P^nMPI configuration ... success
[MUST] Infrastructure in "/pc2/users/b/bauerc/.cache/must/prebuilds/864f3a9f01045835e9b69e097a483388" is pres
ent and used.
[MUST] Search for linked P^nMPI ... not found ... using LD_PRELOAD to load P^nMPI ... success
[MUST] Executing application:
┌ Warning: MPI thread level requested = MPI.ThreadLevel(2), provided = MPI.ThreadLevel(1)
└ @ MPI /scratch/hpc-lco-usrtr/.julia_jlhpc_course/packages/MPI/hhI6i/src/environment.jl:129
┌ Warning: MPI thread level requested = MPI.ThreadLevel(2), provided = MPI.ThreadLevel(1)
└ @ MPI /scratch/hpc-lco-usrtr/.julia_jlhpc_course/packages/MPI/hhI6i/src/environment.jl:129
┌ Warning: MPI thread level requested = MPI.ThreadLevel(2), provided = MPI.ThreadLevel(1)
└ @ MPI /scratch/hpc-lco-usrtr/.julia_jlhpc_course/packages/MPI/hhI6i/src/environment.jl:129
┌ Warning: MPI thread level requested = MPI.ThreadLevel(2), provided = MPI.ThreadLevel(1)
└ @ MPI /scratch/hpc-lco-usrtr/.julia_jlhpc_course/packages/MPI/hhI6i/src/environment.jl:129
Rank 0 will start Recv!/Send soon.
Rank 1 will start Recv!/Send soon.
Rank 2 will start Recv!/Send soon.
Rank 3 will start Recv!/Send soon.
[MUST-RUNTIME] ============MUST===============
[MUST-RUNTIME] ERROR: MUST detected a deadlock, detailed information is available in the MUST output file. Yo
u should either investigate details with a debugger or abort, the operation of MUST will stop from now.
[MUST-RUNTIME] ===============================
```

Visualization:

![graphviz](https://github.com/carstenbauer/parallel-julia-zoo/assets/187980/f0139e83-a3d2-4e8c-a128-afbdb34931c6)<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: Deadlock Pages: 1 --><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="469pt" height="314pt" viewBox="0.00 0.00 468.99 314.40">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 310.4)">
<title>Deadlock</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-310.4 464.9923,-310.4 464.9923,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<polygon fill="none" stroke="#000000" points="104,-269.9 104,-305.9 195.0442,-305.9 195.0442,-269.9 104,-269.9"/>
<text text-anchor="middle" x="149.5221" y="-283.8" font-family="Times,serif" font-size="14.00" fill="#000000">0: MPI_Recv</text>
</g>
<!-- 3 -->
<g id="node2" class="node">
<title>3</title>
<polygon fill="none" stroke="#000000" points="0,-180.1 0,-216.1 91.0442,-216.1 91.0442,-180.1 0,-180.1"/>
<text text-anchor="middle" x="45.5221" y="-194" font-family="Times,serif" font-size="14.00" fill="#000000">3: MPI_Recv</text>
</g>
<!-- 0&#45;&gt;3 -->
<g id="edge1" class="edge">
<title>0-&gt;3</title>
<path fill="none" stroke="#000000" d="M103.8352,-281.4043C84.9772,-276.3516 64.6307,-267.369 52.0519,-251.4 46.4959,-244.3465 44.1962,-235.0562 43.4891,-226.2105"/>
<polygon fill="#000000" stroke="#000000" points="46.9881,-226.12 43.2908,-216.1913 39.9895,-226.2586 46.9881,-226.12"/>
<text text-anchor="middle" x="145.7572" y="-238.8" font-family="Times,serif" font-size="14.00" fill="#000000"> comm=A, tag=MPI_ANY_TAG</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<polygon fill="none" stroke="#000000" points="2,-90.3 2,-126.3 93.0442,-126.3 93.0442,-90.3 2,-90.3"/>
<text text-anchor="middle" x="47.5221" y="-104.2" font-family="Times,serif" font-size="14.00" fill="#000000">2: MPI_Recv</text>
</g>
<!-- 3&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>3-&gt;2</title>
<path fill="none" stroke="#000000" d="M44.3423,-179.8387C43.8468,-169.5446 43.4993,-156.4507 44.0519,-144.8 44.1804,-142.0918 44.3621,-139.2743 44.5759,-136.459"/>
<polygon fill="#000000" stroke="#000000" points="48.0648,-136.738 45.4525,-126.4703 41.0916,-136.126 48.0648,-136.738"/>
<text text-anchor="middle" x="137.7572" y="-149" font-family="Times,serif" font-size="14.00" fill="#000000"> comm=A, tag=MPI_ANY_TAG</text>
</g>
<!-- 1 -->
<g id="node4" class="node">
<title>1</title>
<polygon fill="none" stroke="#000000" points="104,-.5 104,-36.5 195.0442,-36.5 195.0442,-.5 104,-.5"/>
<text text-anchor="middle" x="149.5221" y="-14.4" font-family="Times,serif" font-size="14.00" fill="#000000">1: MPI_Recv</text>
</g>
<!-- 2&#45;&gt;1 -->
<g id="edge4" class="edge">
<title>2-&gt;1</title>
<path fill="none" stroke="#000000" d="M44.5058,-90.2793C43.6456,-79.0557 44.5343,-64.917 52.0519,-55 57.8415,-47.3625 75.5688,-39.7874 94.3464,-33.5344"/>
<polygon fill="#000000" stroke="#000000" points="95.4393,-36.8596 103.9013,-30.4843 93.3105,-30.1911 95.4393,-36.8596"/>
<text text-anchor="middle" x="145.7572" y="-59.2" font-family="Times,serif" font-size="14.00" fill="#000000"> comm=A, tag=MPI_ANY_TAG</text>
</g>
<!-- 1&#45;&gt;0 -->
<g id="edge3" class="edge">
<title>1-&gt;0</title>
<path fill="none" stroke="#000000" d="M195.2256,-26.2665C211.7078,-31.5136 228.6614,-40.2983 238.5221,-55 287.1444,-127.4929 287.1444,-178.9071 238.5221,-251.4 230.5873,-263.2303 218.0597,-271.2292 204.8807,-276.6365"/>
<polygon fill="#000000" stroke="#000000" points="203.4359,-273.4372 195.2256,-280.1335 205.8198,-280.0188 203.4359,-273.4372"/>
<text text-anchor="middle" x="367.7572" y="-149" font-family="Times,serif" font-size="14.00" fill="#000000"> comm=A, tag=MPI_ANY_TAG</text>
</g>
</g>
</svg>

